import{i as b,s as P,b as i,r as d,u as S,N as _,j as t,B as T}from"./index-4f0de649.js";import{I as D,_ as u}from"./index-d88abc85.js";import{s as R}from"./Otp-c4b2742c.js";import{T as z}from"./Typography-115a5f41.js";import{T as B}from"./TextField-ce8f00ce.js";import"./useId-091cb0af.js";import"./Menu-dd567723.js";import"./useTheme-699d2dd2.js";import"./List-73049a0a.js";import"./createSvgIcon-3da887ef.js";const L="rzp_test_aekGbyIJxj3Z8i",N=async(c,f,y,h,x,g,n,j,w,s,l)=>{var p,m;try{const o=await b.post("/wish/payment",{renewBookingAmount:n}),C=(m=(p=o==null?void 0:o.data)==null?void 0:p.order)==null?void 0:m.id,k={key:L,amount:n*100,currency:"INR",name:"CanteenPro",description:"Complete canteen for all of them",order_id:C,handler:async r=>{if(r.razorpay_payment_id){console.log("call comes to paymentid");const v=await b.post(w,{newEndDate:c,active:f,actualEndDate:y,bookingId:h,source:x,count:g,renewBookingAmount:n,newStartDate:j});l("/user/paymentsuccess")}else l("/user/userhome")},prefill:{contact:s},theme:{color:"#3399cc"}};return new Promise((r,v)=>{const a=new window.Razorpay(k);a.on("payment.failed",()=>{r({paymentstatus:!1})}),a.on("payment.success",()=>{r({paymentstatus:!0})}),a.open()})}catch(o){return console.log(o),{networkerror:!0}}},F=P(i)(()=>({display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"70vh"})),Q=()=>{const[c,f]=d.useState(!1),[y,h]=d.useState(null),[x,g]=d.useState(""),n=S(),j=_(),{state:w}=j,{phone:s,bookingId:l,newEndDate:p,actualEndDate:m,active:o,count:C,renewBookingAmount:k,newStartDate:r,source:v}=w||{},a="+91"+s,I="/booking/renewbooking";d.useEffect(()=>{const e=document.createElement("script");return e.src="https://checkout.razorpay.com/v1/checkout.js",e.async=!0,document.body.appendChild(e),()=>{document.body.removeChild(e)}},[]);const E=async()=>{try{const e=await R(a);e?(h(e),f(!0)):u.error("faild to sent OTP....try after sometimes")}catch(e){console.log(e),u.error("faild to sent OTP...please try after sometimes")}},O=async()=>{try{await y.confirm(x),console.log("otp verified"),u("otp verified",{icon:"👏"}),await N(p,o,m,l,v,C,k,r,I,s,n)}catch{u.error("incorrect otp")}};return t.jsxs(i,{children:[t.jsx(D,{position:"top-left",reverseOrder:!1}),t.jsxs(F,{children:[t.jsxs(i,{sx:{backgroundColor:"#17275F",width:"50%",display:"flex",justifyContent:"center",flexDirection:"column",borderRadius:"15px",padding:"2rem"},children:[t.jsx(z,{sx:{textAlign:"center",color:"white",fontWeight:700,fontSize:"24px"},children:"OTP Verification"}),t.jsxs(z,{sx:{textAlign:"center",color:"white",fontWeight:400,fontSize:"16px",marginTop:"0.5rem"},children:["Verify your phone number : +91",s]}),c?null:t.jsx("div",{id:"recaptcha"}),t.jsx(i,{sx:{display:"flex",justifyContent:"center",marginTop:"1rem"},children:t.jsx(B,{label:"Enter OTP",variant:"standard",size:"small",InputLabelProps:{style:{color:"#E4E4E4",fontSize:"16px"}},InputProps:{style:{color:"white"}},inputProps:{maxLength:6},onChange:e=>g(e.target.value)})})]}),t.jsx(i,{sx:{display:"flex",justifyContent:"center",marginTop:"1rem"},children:c?t.jsx(T,{variant:"contained",color:"primary",onClick:O,children:"confirm Otp"}):t.jsx(T,{variant:"contained",color:"primary",onClick:E,children:"Click here to sent OTP"})})]})]})};export{Q as default};
